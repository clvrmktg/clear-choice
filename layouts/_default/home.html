{{- define "variables" -}}
{{- .Store.Set "hasTwic" true -}}
{{- end -}}
{{- define "main" -}}
  {{- partial "partials/hero.html" . -}}
  {{- $twic := .Site.Params.twic -}}
  <section class="[ grid layout--spacing ]">

    <div>
      <h2>Explore Windows &amp; Doors</h2>
      <p class="[ font--4 ch--45 ]">Clear Choice offers a full range of hurricane-rated windows and doors, and custom glasswork — locally crafted in The Bahamas to protect, enhance, and add lasting value to your home or business.</p>
    </div>
    <ul class="[ cards ][ grid md:col--3 gap--2 ]">
      {{ with site.GetPage "services/hurricane-windows-doors" }}
      {{ partial "card.html" (dict
        "page"  .
        "image" .Params.hero
        "alt"   "Storefront"
      ) }}
    {{ end }}
    
    {{ with site.GetPage "section" "services" }}
      {{ $servicesPage := . }}
      {{ $first := index .Params.services 0 }}
      {{ with $first }}
        {{ partial "card.html" (dict
          "page"  $servicesPage
          "title" .name
          "href"  (printf "%s#%s" $servicesPage.RelPermalink (urlize .name))
          "image" .image
          "alt"   .name
        ) }}
      {{ end }}
    {{ end }}
  
    {{ with site.GetPage "services" }}
    {{ partial "card.html" (dict
      "page"  .
      "title" "View All Services"
      "image" .Params.hero
    ) }}
  {{ end }}
  
  
    </ul>
  </section>

  <section class="[ full-width content-grid bg--grey layout--spacing layout--padding ]">

    <div class="[ grid middle md:col--2 gap--3 ]">
      <div>
        <h2 class="[ font--500 ]">{{ .Params.why_clear_choice.title }}</h2>
        <p>{{ .Params.why_clear_choice.subtitle }}</p>  
        <div>
          <ul class="[ benefits ][ grid gap--1 ]">
            {{ range .Params.why_clear_choice.items }}
              <li class="[ benefit ][ grid col-gap--0.5 ]">
                <!-- fill #374151 -->
                <span class="icon">
                  {{ readFile (printf "static/icons/%s" .icon) | safeHTML }}
                </span>
                <!-- #374151 -->
                <div>
                  <strong>{{ .heading }}</strong>
                  <p class="[ pb--0 ]">{{ .text }}</p>
                </div>
              </li>
            {{ end }}
          </ul>
        </div>
      </div>
  
      {{ with .Params.why_clear_choice.image }}
      {{ partial "image.html" (dict 
        "Destination" .
        "PlainText" "Storefront" 
        "class" "ratio--1:1 radius--5"
        "Page" $
      ) }}
      {{ end }}
    </div>
  </section>
  
  <section class="[ local-advantage ][ grid gap--2 layout--spacing ]">

    <div class="[ grid gap--1 ]">
      <div>
        <h2>{{ .Params.local_advantage.title }}</h2>
        <h3 class="[ font--5 ]">{{ .Params.local_advantage.subtitle }}</h3>
      </div>
      <p class="[ ch--45 ]">{{ .Params.local_advantage.text }}</p>
    </div>
  
      {{ range .Params.local_advantage.columns }}
      {{ $col := . }}
      <div class="[ column ][ grid gap--1 ]">
        <h4>{{ $col.heading }}</h4>
        <ul class="[ advantages ]">
          {{ range $col.items }}
          <li class="[ advantage ][ grid middle col-gap--0.5 ]">
            <span class="icon">
              {{ readFile (printf "static/icons/%s" $col.icon) | safeHTML }}
            </span>
            {{ . }}
          </li>
          {{ end }}
        </ul>
      </div>
      {{ end }}
  </section>
 
  {{ partial "reviews.html" . }}

  <section class="[ grid layout--spacing ]">
    <div>
      <h2>Photo Gallery</h2>
      <p class="[ ch--45 ]">
        Explore our recent installations across The Bahamas — from hurricane-rated windows and doors 
        to custom shower enclosures and storefronts. See the difference Clear Choice craftsmanship makes.
      </p>
    </div>
  
    <ul class="[ cards ][ grid md:col--3 gap--2 ]">
      {{ $galleries := where .Site.RegularPages "Section" "gallery" }}
      {{ range $i, $p := $galleries }}
        {{ partial "card.html" (dict
          "page"   $p
          "title"  $p.Title
          "href"   $p.RelPermalink
          "image"  $p.Params.feature.image
          "alt"    $p.Params.feature.alt
        ) }}
      {{ end }}
      
    </ul>

  </section>
  

  <section class="[ snapshot ][ full-width content-grid middle bg layout--padding ]"
    {{ with site.GetPage "about-us" }}
      {{- with .Resources.GetMatch .Params.hero -}}
        data-twic-background="url(image:{{ .RelPermalink }})"
      {{- end -}}
    {{- end -}}>

    <div class="[ wrapper ][ grid ]">
      <div class="[ snapshot__text ][ radius--5 px--2 py--5 ]">
        <h2>About Clear Choice</h2>
        <div class="[ ch--45 ]">
          {{ .Params.snapshot | markdownify }}
        </div>
        <a href="/about-us" class="[ btn btn--lg cc--primary ]" data-prefetch>Learn More
          <span class="[ hidden ]"> About Us</span>
        </a>
      </div>

    </div>
  </section>
{{- end -}}