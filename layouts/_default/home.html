{{- define "variables" -}}
{{- .Store.Set "hasTwic" true -}}
{{- end -}}
{{- define "main" -}}
  {{- partial "partials/hero.html" . -}}
  {{- $twic := .Site.Params.twic -}}
  <section class="[ grid layout--spacing ]">

    <div>
      <h2>Explore Windows &amp; Doors</h2>
      <p class="[ font--4 ch--45 ]">Clear Choice offers a full range of impact windows, doors, and custom glass solutions —  designed to protect, enhance, and add lasting value to your home or business.</p>
    </div>
    <ul class="[ services ][ grid md:col--3 gap--2 ]">

      {{ with site.GetPage "services/hurricane-windows-doors" }}
      {{ $servicePage := . }}
      <li class="[ service ][ radius--5 ]">
        <a class="[ radius--5 ]" href="{{ $servicePage.RelPermalink }}" data-prefetch>
          {{ with $servicePage.Params.hero }}
            {{ partial "image.html" (dict 
                "Destination" .
                "PlainText" "Storefront"
                "class" "ratio--1:1 scale radius--5"
                "Page" $servicePage
            ) }}
          {{ end }}
          {{/* 
            <h3 class="[ font--4 font--500 ]">
              <span>{{ $servicePage.Title }}</span>
            </h3>
            {{ readFile "static/icons/square-arrow-out-up-right.svg" | safeHTML }}
          */}}
        </a>
      </li>
    {{ end }}
    
    {{ with site.GetPage "section" "services" }}
      {{ $servicesPage := . }}
      {{ $first := index .Params.services 0 }}
      {{ with $first }}
        <li class="[ service ][ radius--5 ]">
          <a href="{{ $servicesPage.RelPermalink }}#{{ urlize .name }}" class="[ radius--5 ]">
            {{ with $servicesPage.Resources.GetMatch .image }}
            {{ partial "image.html" (dict 
              "Destination" .Name 
              "PlainText" $first.name
              "class" "ratio--1:1 scale radius--5"
              "Page" $servicesPage
            ) }}
            {{ end }}
            {{/* 
              <h3 class="[ font--4 font--500 ]">
                <span>{{ .name }}</span>
              </h3>
              {{ readFile "static/icons/square-arrow-out-up-right.svg" | safeHTML }}
            */}}
          </a>
        </li>
      {{ end }}
    {{ end }}

      <li class="[ service ][ radius--5 ]">
        <a class="[ p--1 ]" href="/services" data-prefetch>
          <span class="[ font--4 font--500 ]">View All Services</span>
          {{ readFile "static/icons/square-arrow-out-up-right.svg" | safeHTML }}
        </a>
      </li>
    </ul>
  </section>

  <section class="[ full-width content-grid bg--grey layout--spacing layout--padding ]">

    <div class="[ grid middle md:col--2 gap--3 ]">
      <div>
        <h2 class="[ font--500 ]">{{ .Params.why_clear_choice.title }}</h2>
        <p>{{ .Params.why_clear_choice.subtitle }}</p>  
        <div>
          <ul class="[ benefits ][ grid gap--1 ]">
            {{ range .Params.why_clear_choice.items }}
              <li class="[ benefit ][ grid col-gap--0.5 ]">
                <!-- fill #374151 -->
                <span class="icon">
                  {{ readFile (printf "static/icons/%s" .icon) | safeHTML }}
                </span>
                <!-- #374151 -->
                <div>
                  <strong>{{ .heading }}</strong>
                  <p class="[ pb--0 ]">{{ .text }}</p>
                </div>
              </li>
            {{ end }}
          </ul>
        </div>
      </div>
  
      {{ with .Params.why_clear_choice.image }}
      {{ partial "image.html" (dict 
        "Destination" .
        "PlainText" "Storefront" 
        "class" "ratio--1:1 radius--5"
        "Page" $
      ) }}
      {{ end }}
    </div>
  </section>
  
  <section class="[ local-advantage ][ grid gap--2 layout--spacing ]">

    <div class="[ grid gap--1 ]">
      <div>
        <h2>{{ .Params.local_advantage.title }}</h2>
        <h3 class="[ font--5 ]">{{ .Params.local_advantage.subtitle }}</h3>
      </div>
      <p class="[ ch--45 ]">{{ .Params.local_advantage.text }}</p>
    </div>
  
      {{ range .Params.local_advantage.columns }}
      {{ $col := . }}
      <div class="[ column ][ grid gap--1 ]">
        <h4>{{ $col.heading }}</h4>
        <ul class="[ advantages ]">
          {{ range $col.items }}
          <li class="[ advantage ][ grid middle col-gap--0.5 ]">
            <span class="icon">
              {{ readFile (printf "static/icons/%s" $col.icon) | safeHTML }}
            </span>
            {{ . }}
          </li>
          {{ end }}
        </ul>
      </div>
      {{ end }}
  </section>
 
  {{ partial "reviews.html" . }}

  <section class="[ grid layout--spacing ]">
    <div>
      <h2>Photo Gallery</h2>
      <p class="[ ch--45 ]">
        Explore our recent installations across The Bahamas — from hurricane-rated windows and doors 
        to custom shower enclosures and storefronts. See the difference Clear Choice craftsmanship makes.
      </p>
    </div>
  
    <ul class="[ grid md:col--3 gap--2 ]">
      {{ $counter := 0 }}
      {{ $galleries :=  where .Site.RegularPages "Section" "gallery" }}
      {{ range $galleries }}
      {{ $counter = add $counter 1 }}
        <li>
          <a href="{{ .RelPermalink }}" class="gallery-card" data-prefetch>
            {{ with .Resources.GetMatch .Params.feature.image }}
            <figure class="[ feature__img ][ ratio--1:1 scale radius--5 o--1 ]">
              <picture id="gallery-{{ $counter }}" class="[ bg ]">
                <style>#gallery-{{ $counter | safeCSS  }} {background-image: url('https://{{ $twic }}.twic.pics{{ .RelPermalink }}?twic=v1/output=preview');}</style>
                <img data-twic-src="image:{{ .RelPermalink }}" data-twic-focus="auto" alt="{{ .Params.alt }}" width="{{ .Width }}" height="{{ .Height }}"/>
                <noscript><img class="[ script ]" src="https://{{ $twic }}.twic.pics{{ .RelPermalink }}?twic=v1/output=preview" alt="{{ .Params.alt }}" width="{{ .Width }}" height="{{ .Height }}"/></noscript>
              </picture>
            </figure>
            {{ end }}
            <h3>{{ .Title }}</h3>
          </a>
        </li>
      {{ end }}
    </ul>

  </section>
  

  <section class="[ snapshot ][ full-width content-grid middle bg layout--padding ]"
  {{ with site.GetPage "about-us" }}
    {{ with .Resources.GetMatch .Params.hero }}
      data-twic-background="url(image:{{ .RelPermalink }})"
    {{ end }}
  {{ end }}>


    <div class="[ wrapper ][ grid ]">
      <div class="[ snapshot__text ][ radius--5 px--2 py--5 ]">
        <h2>About Clear Choice</h2>
        <p class="[ ch--45 ]">
          Clear Choice Glass is a Bahamian-owned manufacturer and installer of premium hurricane-rated windows, doors, and custom glass solutions. With over 50 years of combined experience, our Nassau-based team delivers reliable, high-quality installations and local servicing you can trust. We take pride in providing lasting protection, modern style, and dedicated support for both residential and commercial clients.
        </p>
        <a href="/about-us" class="[ btn btn--lg ]" data-prefetch>Learn More
          <span class="[ hidden ]"> About Us</span>
        </a>
      </div>

    </div>
  </section>

  {{ partial "cta.html" . }}

{{- end -}}